// Prisma schema for employee attendance system

generator client {
  provider = "prisma-client-js"
  // output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum AttendanceType {
  checkin
  checkout
  late
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  role      String   @default("employee") // employee | admin
  attendances Attendance[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Attendance {
  id         Int            @id @default(autoincrement())
  user      User           @relation(fields: [userId], references: [id])
  userId    Int
  zona      Zona           @relation(fields: [zonaId], references: [id])
  zonaId    Int
  type      AttendanceType
  createdAt DateTime       @default(now())
}

model Company {
  id      Int     @id @default(autoincrement())
  name    String  @unique
  zonas   Zona[]
}

model Zona {
  id         Int      @id @default(autoincrement())
  name       String   @unique
  company    Company  @relation(fields: [companyId], references: [id])
  companyId  Int
  attendances Attendance[]
  schedules  ZonaSchedule[]
}

model ZonaSchedule {
  id              Int    @id @default(autoincrement())
  zona            Zona   @relation(fields: [zonaId], references: [id])
  zonaId          Int    @unique
  checkinTime     String // format: 'HH:mm'
  checkoutTime    String // format: 'HH:mm'
  toleranceMin    Int    // toleransi keterlambatan (menit)
}
